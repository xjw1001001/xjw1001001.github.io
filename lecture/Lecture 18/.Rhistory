knitr::opts_chunk$set(
comment = "",eval = TRUE,fig.retina = 2, message=F, warning = F, fig.height = 4.5
)
set.seed(0)
sampled1000_1 <- rnorm(1000, 11, 1.5)
head(sampled1000_1, 20)
mean(sampled1000_1)
set.seed(10)
sampled1000_2 <- rnorm(1000, 11, 1.5)
head(sampled1000_2, 20)
mean(sampled1000_2)
all.equal(mean(sampled1000_1), mean(sampled1000_2))
```
set.seed(10)
sampled1000_2 <- rnorm(1000, 11, 1.5)
head(sampled1000_2, 20)
mean(sampled1000_2)
all.equal(mean(sampled1000_1), mean(sampled1000_2))
```
set.seed(10)
sampled1000_2 <- rnorm(1000, 11, 1.5)
head(sampled1000_2, 20)
mean(sampled1000_2)
all.equal(mean(sampled1000_1), mean(sampled1000_2))
set.seed(0)
repeat10000 <- t(replicate(n = 10000, rnorm(1000, 11, 1.5)))
str(repeat10000)
head(rowMeans(repeat10000), 20)
means10000 <- rowMeans(repeat10000)
repeat10000
\
dim(repeat10000)
data.frame(shoesMean = means10000) %>%
ggplot(aes(x = shoesMean)) +
geom_density() +
labs(x = "Mean of sample of size 1000",
y = "Density",
title = "Sampling distribution from N(11, 1.5^2)")
xaringanExtra::use_xaringan_extra(c("tile_view", "animate_css", "tachyons"))
xaringanExtra::use_panelset()
knitr::opts_chunk$set(
comment = "",eval = TRUE,fig.retina = 2, message=F, warning = F, fig.height = 4.5
)
library(dplyr)
library(ggplot2)
library(unvotes)
library(tidyverse)
library(openintro)
knitr::include_graphics("img/soup.png")
data.frame(shoesMean = means10000) %>%
ggplot(aes(x = shoesMean)) +
geom_density() +
labs(x = "Mean of sample of size 1000",
y = "Density",
title = "Sampling distribution from N(11, 1.5^2)")
data.frame(shoesMean = means10000) %>%
ggplot(aes(x = shoesMean)) +
geom_density() +
labs(x = "Mean shoe size of sample of size 1000",
y = "Density",
title = "Sampling distribution from N(11, 1.5^2)")
set.seed(0)
repeat10000_n50 <- t(replicate(n = 10000, rnorm(50, 11, 1.5)))
str(repeat10000_n50)
head(rowMeans(repeat10000_n50), 20)
means10000_n50 <- rowMeans(repeat10000_n50)
data.frame(shoesMean = means10000, sampleSize = 1000) %>%
bind_rows(
data.frame(means10000_n50, sampleSize = 50) %>%
rename(shoesMean = means10000_n50)
)  %>%
ggplot(aes(x = shoesMean,
fill = as.factor(sampleSize))) +
geom_density() +
labs(x = "Mean shoe size",
y = "Density",
title = "Sampling distribution from N(11, 1.5^2)",
fill = "Sample size")  +
scale_fill_viridis_d()
# guides(fill = "none")
data.frame(shoesMean = means10000, sampleSize = 1000) %>%
bind_rows(
data.frame(means10000_n50, sampleSize = 50) %>%
rename(shoesMean = means10000_n50)
)  %>%
ggplot(aes(x = shoesMean,
fill = as.factor(sampleSize))) +
geom_density(aplha = 0.7) +
labs(x = "Mean shoe size",
y = "Density",
title = "Sampling distribution from N(11, 1.5^2)",
fill = "Sample size")  +
scale_fill_viridis_d()
# guides(fill = "none")
data.frame(shoesMean = means10000, sampleSize = 1000) %>%
bind_rows(
data.frame(means10000_n50, sampleSize = 50) %>%
rename(shoesMean = means10000_n50)
)  %>%
ggplot(aes(x = shoesMean,
fill = as.factor(sampleSize),
alpha = 0.7)) +
geom_density() +
labs(x = "Mean shoe size",
y = "Density",
title = "Sampling distribution from N(11, 1.5^2)",
fill = "Sample size")  +
scale_fill_viridis_d()
# guides(fill = "none")
data.frame(shoesMean = means10000, sampleSize = 1000) %>%
bind_rows(
data.frame(means10000_n50, sampleSize = 50) %>%
rename(shoesMean = means10000_n50)
)
data.frame(shoesMean = means10000, sampleSize = 1000) %>%
bind_rows(
data.frame(means10000_n50, sampleSize = 50) %>%
rename(shoesMean = means10000_n50)
)  %>%head(2)
data.frame(shoesMean = means10000, sampleSize = 1000) %>%
bind_rows(
data.frame(means10000_n50, sampleSize = 50) %>%
rename(shoesMean = means10000_n50)
)  %>%head(3)
data.frame(shoesMean = means10000, sampleSize = 1000) %>%
bind_rows(
data.frame(means10000_n50, sampleSize = 50) %>%
rename(shoesMean = means10000_n50)
)  %>%
ggplot(aes(x = shoesMean,
fill = as.factor(sampleSize),
alpha = 0.7)) +
geom_density() +
labs(x = "Mean shoe size",
y = "Density",
title = "Sampling distribution from N(11, 1.5^2)",
fill = "Sample size")  +
scale_fill_viridis_d()
# guides(fill = "none")
source("~/.active-rstudio-document", echo=TRUE)
knitr::opts_chunk$set(
comment = "",eval = TRUE,fig.retina = 2, message=F, warning = F, fig.height = 4.5
)
knitr::include_graphics("img/ci2.png")
1 - pnorm(324, 435*.75, sd = sqrt(435*.75*.25))
sum(dbinom(325:435, 435, 0.75))
myDraws <- rnorm(1000, mean = 3, sd = 5)
xBar <- mean(myDraws)
n <- length(myDraws)
halfWidth <- qnorm(.975)*5/sqrt(n)
(lower <- xBar - halfWidth)
(upper <- xBar + halfWidth)
knitr::opts_chunk$set(
comment = "",eval = TRUE,fig.retina = 2, message=F, warning = F, fig.height = 4.5
)
myDraws <- rnorm(1000, mean = 3, sd = 5)
xBar <- mean(myDraws)
n <- length(myDraws)
halfWidth <- qnorm(.975)*5/sqrt(n)
(lower <- xBar - halfWidth)
(upper <- xBar + halfWidth)
set.seed(0)
CIsDF <- data.frame(lower = rep(NA, 5000), upper = rep(NA, 5000))
for (i in 1:nrow(CIsDF)) {
myDraws <- rnorm(1000, mean = 3, sd = 5)
xBar <- mean(myDraws)
n <- length(myDraws)
halfWidth <- qnorm(.975)*5/sqrt(n)
CIsDF[i, "lower"] <- xBar - halfWidth
CIsDF[i, "upper"] <- xBar + halfWidth
}
CIsDF %>%
mutate(index = 1:nrow(CIsDF),
estimate = (lower + upper)/2) %>%
slice(1:20) %>%
ggplot(aes(estimate, index)) +
geom_pointrange(aes(xmin = lower, xmax = upper)) +
geom_vline(xintercept = 3, colour = "grey60", linetype = 2) +
labs(title = "First 20 CIs for population mean",
x = "Estimate",
y = "Index")
CIsDF %>%
mutate(index = 1:nrow(CIsDF),
estimate = (lower + upper)/2) %>%
slice(1:20) %>%
ggplot(aes(estimate, index)) +
geom_pointrange(aes(xmin = lower, xmax = upper)) +
geom_vline(xintercept = 3, colour = "grey60", linetype = 2) +
labs(title = "First 20 CIs for population mean",
x = "Estimate",
y = "Index")
sum(CIsDF$lower <= 3 & CIsDF$upper >= 3)
sum(CIsDF$lower <= 3 & CIsDF$upper >= 3) / nrow(CIsDF)
set.seed(0)
CIsDF <- data.frame(lower = rep(NA, 5000), upper = rep(NA, 5000))
for (i in 1:nrow(CIsDF)) {
myDraws <- rnorm(1000, mean = 3, sd = 5)
xBar <- mean(myDraws)
n <- length(myDraws)
halfWidth <- qnorm(.95)*5/sqrt(n)
CIsDF[i, "lower"] <- xBar - halfWidth
CIsDF[i, "upper"] <- xBar + halfWidth
}
sum(CIsDF$lower <= 3 & CIsDF$upper >= 3)
sum(CIsDF$lower <= 3 & CIsDF$upper >= 3) / nrow(CIsDF)
qt(.025, df = 19, lower.tail = FALSE)
knitr::include_graphics("img/guinness.png")
knitr::include_graphics("img/normalt.png")
knitr::include_graphics("img/flintdetroit.jpg")
xBar <- mean(flint$Pb_initial)
flint <- readxl::read_excel("./data/Flint-Samples.xlsx", sheet = 1) %>%
rename("Pb_initial"="Pb Bottle 1 (ppb) - First Draw")
str(flint)
xBar <- mean(flint$Pb_initial)
sigma2 <- var(flint$Pb_initial)
n <- length(flint$Pb_initial)
halfWidth <- qnorm(.975)*sqrt(sigma2/n)
(lower <- xBar - halfWidth)
(upper <- xBar + halfWidth)
t.test(flint$Pb_initial)
flint <- flint %>%
mutate(Pbover15 = Pb_initial > 15)
pHat <- mean(flint$Pbover15)
var <- pHat*(1 - pHat)/length(flint$Pbover15)
halfWidth <- qnorm(.975)*sqrt(var)
(lower <- pHat - halfWidth)
(upper <- pHat + halfWidth)
knitr::opts_chunk$set(
comment = "",eval = TRUE,fig.retina = 2, message=F, warning = F, fig.height = 4.5
)
library(renderthis)
to_pdf(from = "lecture16.html",complex_slides = TRUE)
knitr::opts_chunk$set(
comment = "",eval = TRUE,fig.retina = 2, message=F, warning = F, fig.height = 4.5
)
library(renderthis)
to_pdf(from = "lecture18.html",complex_slides = TRUE)
knitr::opts_chunk$set(
comment = "",eval = TRUE,fig.retina = 2, message=F, warning = F
)
library(renderthis)
to_pdf(from = "Discussion-5-sampling,-ggplot2.html",complex_slides = TRUE)
