# Don't change anything here
knitr::opts_chunk$set(
comment = "", prompt = F, message=F, warning = F
)
#install.packages("ggplot2")
#install.packages("tidyverse")
#install.packages("ggthemes")
#install.packages("ggrepel")
#install.packages("ggwordcloud")
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(ggwordcloud)
myfile <- "https://raw.githubusercontent.com/xjw1001001/xjw1001001.github.io/main/data/homework%20data/baby_names.csv"
data = read.csv(myfile)
head(data)
# Get the dimensions of the data frame
dim(data)
# Count the number of observations for each sex
table(data$Sex)
data %>%
count(Year) %>%
arrange(Year) %>%
head(5)
data %>%
select(Count, Sex, Name, Year) %>%
filter(Sex == "F", Year == 2010, Count > 3000)
data %>%
filter(Year >= 1995 & Year <= 2000) %>%
group_by(Year) %>%
summarize(max_count = max(Count), avg_count = mean(Count)) %>%
knitr::kable(digits = 3)
head(diamonds)
ggplot(diamonds, aes(x = carat)) +
geom_histogram(binwidth = 0.5) +
labs(x = "x", y = "Frequency", title = "Binwidth 0.5")
ggplot(diamonds, aes(x = carat)) +
geom_histogram(binwidth = 0.05) +
labs(x = "x", y = "Frequency", title = "Binwidth 0.05")
cor(diamonds$carat,diamonds$price)
# Scatter plot
ggplot(diamonds, aes(x = carat, y = price)) +
geom_point(alpha = 0.5)
# Hex plot
ggplot(diamonds, aes(x = carat, y = price)) +
geom_hex(bins=25)
ggplot(diamonds, aes(x = price, y = cut)) +
geom_boxplot(fill = "lightblue", color = "blue") +
labs(
x = "Price",
y = "Cut",
title = "Distribution of Diamond Price by Cut"
)
ggplot(diamonds, aes(x = carat, fill = color)) +
geom_density(adjust =2) +
facet_wrap(~color, nrow = 2) +
labs(x = "Carat", y = "Count")
data %>%
filter(Year >= 2005 & Year <= 2010) %>% # Keep only years 2005-2015
group_by(Year, Sex) %>% # Group by year and sex
slice_max(Count) %>% # Select the most common name for each group
select(Year, Sex, Name, Count) # Select relevant columns
data %>%
group_by(Sex, Year) %>%
summarise(total = sum(Count)) %>%
filter(Year <= 2015 & Year >= 2008) %>%
ggplot(aes(x = Year, y = total, fill = Sex)) +
geom_bar(stat = "identity", position = "Dodge") +
labs(x = "Year", y = "Count", title = "Total Count of Male vs. Female Names") +
theme_economist()
names = c("Jessica", "Emily", "Isabella", "Amanda", "Jennifer")
data %>%
filter(Name %in% names) %>%
filter(Sex == "F") %>%
ggplot(aes(x = Year, y = Count, color = Name)) +
geom_line() +
labs(x = "Year", y = "Total Count", title = "Trend in Number of Selected Names") +
scale_color_viridis_d(option = "H") +
theme_economist()
data %>% group_by(Sex, Name) %>%
summarise(Count = sum(Count)) %>%
arrange(desc(Count)) %>%
head(50) %>%
ggplot(aes(label = Name, size = Count, color = Sex)) +
geom_text_wordcloud() +
theme_minimal()
data %>% group_by(Sex, Name) %>%
summarise(Count = sum(Count))
data %>% group_by(Name, Sex) %>%
summarise(Count = sum(Count))
